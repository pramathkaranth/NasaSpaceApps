<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clean Air Compass</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Earth & Sky Neutrals -->
    <!-- Application Structure Plan: A single-page dashboard application with tab-based navigation to switch between views: 'Live Map', 'Forecast', 'Data Comparison', and 'Historical Trends'. This structure allows users to quickly access the most important real-time information (the map) while providing dedicated, uncluttered sections for deeper data exploration. The flow is centered on location selection, which then populates all other views with relevant data, creating a cohesive and intuitive user experience. -->
    <!-- Visualization & Content Choices: Live AQI -> Inform -> Color-coded card (HTML/CSS) -> Updates on location change -> At-a-glance status. Pollutant Breakdown -> Inform -> Donut Chart (Chart.js) -> Hover tooltips -> Shows composition. Interactive Map -> Organize/Explore -> Simulated map with clickable points (HTML/CSS/JS) -> Click to select location -> Geographic context and primary navigation. Forecast -> Change over time -> Line Chart (Chart.js) -> Hover tooltips -> Shows predicted trends for planning. Data Comparison -> Compare/Validate -> Grouped Bar Chart (Chart.js) -> Select pollutant -> Builds user trust by showing data sources. Historical Trends -> Change over time -> Line Chart with date selectors (Chart.js + HTML) -> User selects range -> Fulfills analysis feature for researchers. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 40vh;
            max-height: 400px;
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .nav-link.active {
            color: #1d4ed8;
            border-bottom-color: #1d4ed8;
        }
        .city-dot {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .city-dot:hover {
            transform: scale(1.5);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.7);
        }
        .map-bg {
            background-image: url('https://placehold.co/1200x800/2c3e50/ffffff?text=North+America');
            background-size: cover;
            background-position: center;
        }
    </style>
</head>
<body class="text-gray-800">

    <div id="app" class="min-h-screen flex flex-col">
        <header class="bg-white shadow-md sticky top-0 z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center">
                        <span class="text-white text-2xl">üå¨Ô∏è</span>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-800">Clean Air Compass</h1>
                </div>
                <div class="hidden md:flex items-center space-x-2">
                     <input type="text" id="locationSearch" placeholder="Search for a city..." class="px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>
            <nav class="bg-gray-50 border-b border-gray-200">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="flex justify-center space-x-8">
                        <a href="#" class="nav-link active py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-view="dashboard">Dashboard</a>
                        <a href="#" class="nav-link py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-view="forecast">Forecast</a>
                        <a href="#" class="nav-link py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-view="comparison">Data Comparison</a>
                        <a href="#" class="nav-link py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-view="history">Historical Trends</a>
                        <a href="#" class="nav-link py-3 px-1 border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300" data-view="about">About</a>
                    </div>
                </div>
            </nav>
        </header>

        <main class="flex-grow">
            <!-- Dashboard View -->
            <div id="dashboard" class="view p-4 md:p-8">
                 <div class="max-w-7xl mx-auto">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold">Air Quality Dashboard</h2>
                        <p class="text-gray-600 mt-2">Live insights for <span id="current-city-dashboard" class="font-semibold text-blue-600">Los Angeles</span>. Click a city on the map to explore.</p>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow-lg">
                            <h3 class="text-xl font-semibold mb-4 text-center">Interactive Map</h3>
                            <div class="relative w-full h-96 rounded-lg overflow-hidden map-bg">
                                <!-- Mock City Dots -->
                                <button class="city-dot absolute w-4 h-4 rounded-full border-2 border-white" style="top: 55%; left: 18%;" data-city="Los Angeles" title="Los Angeles"></button>
                                <button class="city-dot absolute w-4 h-4 rounded-full border-2 border-white" style="top: 78%; left: 35%;" data-city="Mexico City" title="Mexico City"></button>
                                <button class="city-dot absolute w-4 h-4 rounded-full border-2 border-white" style="top: 40%; left: 80%;" data-city="New York" title="New York"></button>
                                <button class="city-dot absolute w-4 h-4 rounded-full border-2 border-white" style="top: 35%; left: 50%;" data-city="Chicago" title="Chicago"></button>
                                <button class="city-dot absolute w-4 h-4 rounded-full border-2 border-white" style="top: 25%; left: 30%;" data-city="Edmonton" title="Edmonton"></button>
                            </div>
                        </div>

                        <div class="space-y-8">
                            <div id="aqi-card" class="bg-white p-6 rounded-lg shadow-lg text-center transition-colors duration-500">
                                <h3 class="text-xl font-semibold mb-2">Current AQI</h3>
                                <p id="aqi-value" class="text-7xl font-bold"></p>
                                <p id="aqi-level" class="text-2xl font-medium mt-2"></p>
                                <p id="aqi-advice" class="text-gray-500 mt-4 text-sm"></p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-lg">
                                <h3 class="text-xl font-semibold mb-4 text-center">Key Pollutant Breakdown</h3>
                                <div class="chart-container" style="height:250px; max-height: 250px;">
                                    <canvas id="pollutantChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                 </div>
            </div>

            <!-- Forecast View -->
            <div id="forecast" class="view hidden p-4 md:p-8">
                <div class="max-w-7xl mx-auto">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold">24-Hour AQI Forecast</h2>
                        <p class="text-gray-600 mt-2">Predicted air quality trends for <span id="current-city-forecast" class="font-semibold text-blue-600">Los Angeles</span>.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <div class="chart-container">
                            <canvas id="forecastChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Comparison View -->
            <div id="comparison" class="view hidden p-4 md:p-8">
                <div class="max-w-7xl mx-auto">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold">Data Source Comparison</h2>
                        <p class="text-gray-600 mt-2">Comparing satellite and ground sensor data for <span id="current-city-comparison" class="font-semibold text-blue-600">Los Angeles</span>.</p>
                         <p class="text-sm text-gray-500 mt-2">This feature enhances transparency by showing how data from different sources align, building trust in the provided air quality information.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <div class="flex justify-center mb-4">
                             <select id="pollutantSelector" class="px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="no2">Nitrogen Dioxide (NO‚ÇÇ)</option>
                                <option value="o3">Ozone (O‚ÇÉ)</option>
                            </select>
                        </div>
                        <div class="chart-container">
                            <canvas id="comparisonChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- History View -->
            <div id="history" class="view hidden p-4 md:p-8">
                 <div class="max-w-7xl mx-auto">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold">Historical Air Quality Trends</h2>
                        <p class="text-gray-600 mt-2">Analyzing past monthly average AQI for <span id="current-city-history" class="font-semibold text-blue-600">Los Angeles</span>.</p>
                         <p class="text-sm text-gray-500 mt-2">Explore long-term trends to understand seasonal patterns and the impact of environmental policies.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                         <div class="flex justify-center mb-4">
                             <select id="historyYearSelector" class="px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="2024">2024</option>
                                <option value="2025">2025</option>
                            </select>
                        </div>
                        <div class="chart-container">
                            <canvas id="historyChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- About View -->
            <div id="about" class="view hidden p-4 md:p-8">
                <div class="max-w-5xl mx-auto bg-white p-8 rounded-lg shadow-lg">
                    <h2 class="text-3xl font-bold text-center mb-6">About Clean Air Compass</h2>
                    <div class="prose max-w-none text-gray-700">
                        <p><strong>Clean Air Compass</strong> is a proof-of-concept application developed for the NASA Space Apps Challenge 2025. Our vision is to create a dynamic, open-source platform that harmonizes real-time satellite data from NASA's TEMPO mission with ground-based air quality measurements and meteorological data. The goal is to provide accurate, hyper-local air quality forecasts and proactive health alerts, empowering vulnerable communities and policymakers to mitigate the health impacts of air pollution.</p>
                        
                        <h3 class="text-xl font-semibold mt-6">Core Features</h3>
                        <ul>
                            <li><strong>Unified Air Quality Map:</strong> An interactive view of air quality across North America.</li>
                            <li><strong>Hyper-Local Forecasting:</strong> A machine learning model generating forecasts for the next 24-48 hours.</li>
                            <li><strong>Real-Time Data Comparison:</strong> A unique feature to compare satellite (e.g., TEMPO) and ground-based sensor data for validation.</li>
                        </ul>

                        <h3 class="text-xl font-semibold mt-6">Data Sources</h3>
                        <p>This application simulates the integration of data from world-class sources, including:</p>
                        <ul>
                            <li><strong>NASA TEMPO, OMI, and TROPOMI missions</strong> for satellite-based atmospheric measurements.</li>
                            <li><strong>OpenAQ and Pandora Project</strong> for real-time, ground-based sensor readings.</li>
                            <li><strong>Public Weather APIs</strong> for meteorological data crucial to forecasting.</li>
                        </ul>
                        
                        <h3 class="text-xl font-semibold mt-6">Community & Public Engagement</h3>
                        <p>A future version of this app will include a "citizen scientist" component, allowing users to report local air quality conditions. This crowd-sourced data will help validate and improve our forecasting models, fostering public engagement and aligning with open-science principles.</p>
                    </div>
                </div>
            </div>

        </main>
        
        <footer class="bg-white mt-8 border-t">
            <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-gray-500 text-sm">
                <p>&copy; 2025 Clean Air Compass. A project for the NASA Space Apps Challenge.</p>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const appState = {
                currentView: 'dashboard',
                selectedCity: 'Los Angeles',
            };

            const mockData = {
                "Los Angeles": {
                    current: { aqi: 78, level: 'Moderate', advice: 'Unusually sensitive groups should reduce outdoor activity.', pollutants: { no2: 45, o3: 80, pm25: 60 } },
                    forecast: [78, 82, 85, 88, 90, 86, 81, 75, 72, 68, 65, 63, 68, 73, 79, 84, 89, 92, 95, 91, 87, 82, 78, 75],
                    comparison: { no2: { tempo: 42, ground: 45 }, o3: { tempo: 85, ground: 80 } },
                    history: { "2024": [55, 62, 68, 75, 82, 90, 88, 85, 78, 70, 65, 60], "2025": [58, 65, 72, 78, 85, 93, 91, 88, 81, 74, 68, 62] }
                },
                "Mexico City": {
                    current: { aqi: 125, level: 'Unhealthy for Sensitive Groups', advice: 'Sensitive groups should avoid strenuous outdoor activity.', pollutants: { no2: 60, o3: 110, pm25: 125 } },
                    forecast: [125, 128, 130, 135, 138, 133, 129, 122, 118, 115, 110, 108, 112, 118, 125, 130, 136, 140, 142, 138, 131, 125, 120, 118],
                    comparison: { no2: { tempo: 58, ground: 60 }, o3: { tempo: 115, ground: 110 } },
                    history: { "2024": [80, 88, 95, 105, 115, 125, 120, 118, 110, 100, 90, 85], "2025": [85, 92, 100, 110, 120, 130, 125, 122, 115, 105, 95, 88] }
                },
                "New York": {
                    current: { aqi: 45, level: 'Good', advice: 'Air quality is excellent. Enjoy outdoor activities.', pollutants: { no2: 25, o3: 50, pm25: 30 } },
                    forecast: [45, 42, 40, 38, 35, 38, 41, 44, 48, 50, 52, 51, 49, 46, 43, 41, 40, 39, 38, 40, 42, 45, 47, 48],
                    comparison: { no2: { tempo: 22, ground: 25 }, o3: { tempo: 55, ground: 50 } },
                    history: { "2024": [30, 35, 40, 45, 50, 55, 53, 50, 45, 40, 38, 32], "2025": [32, 38, 42, 48, 53, 58, 55, 52, 48, 42, 39, 35] }
                },
                "Chicago": {
                    current: { aqi: 65, level: 'Moderate', advice: 'Unusually sensitive groups should reduce outdoor activity.', pollutants: { no2: 35, o3: 70, pm25: 55 } },
                    forecast: [65, 68, 70, 72, 75, 71, 68, 64, 60, 58, 55, 53, 56, 61, 66, 70, 74, 78, 80, 76, 72, 68, 65, 62],
                    comparison: { no2: { tempo: 33, ground: 35 }, o3: { tempo: 75, ground: 70 } },
                    history: { "2024": [45, 50, 58, 65, 72, 80, 78, 75, 68, 60, 55, 50], "2025": [48, 55, 62, 68, 75, 83, 81, 78, 71, 64, 58, 52] }
                },
                 "Edmonton": {
                    current: { aqi: 25, level: 'Good', advice: 'Air quality is excellent. Enjoy outdoor activities.', pollutants: { no2: 15, o3: 30, pm25: 20 } },
                    forecast: [25, 23, 21, 20, 18, 20, 22, 25, 28, 30, 32, 31, 29, 26, 24, 22, 21, 20, 19, 21, 23, 25, 27, 28],
                    comparison: { no2: { tempo: 14, ground: 15 }, o3: { tempo: 33, ground: 30 } },
                    history: { "2024": [20, 25, 30, 35, 40, 45, 43, 40, 35, 30, 28, 22], "2025": [22, 28, 32, 38, 43, 48, 45, 42, 38, 32, 29, 25] }
                }
            };
            
            const charts = {};

            const getAqiColor = (aqi) => {
                if (aqi <= 50) return { bg: 'bg-green-100', text: 'text-green-800', border: 'border-green-500' };
                if (aqi <= 100) return { bg: 'bg-yellow-100', text: 'text-yellow-800', border: 'border-yellow-500' };
                if (aqi <= 150) return { bg: 'bg-orange-100', text: 'text-orange-800', border: 'border-orange-500' };
                return { bg: 'bg-red-100', text: 'text-red-800', border: 'border-red-500' };
            };
            
            const updateDashboard = () => {
                const cityData = mockData[appState.selectedCity].current;
                const colors = getAqiColor(cityData.aqi);

                document.getElementById('current-city-dashboard').textContent = appState.selectedCity;
                const aqiCard = document.getElementById('aqi-card');
                aqiCard.className = `p-6 rounded-lg shadow-lg text-center transition-colors duration-500 ${colors.bg} ${colors.text}`;

                document.getElementById('aqi-value').textContent = cityData.aqi;
                document.getElementById('aqi-level').textContent = cityData.level;
                document.getElementById('aqi-advice').textContent = cityData.advice;

                updateCityDotColors();
                updatePollutantChart();
            };

            const updateCityDotColors = () => {
                document.querySelectorAll('.city-dot').forEach(dot => {
                    const city = dot.dataset.city;
                    const aqi = mockData[city].current.aqi;
                    let colorClass = 'bg-green-500';
                    if (aqi > 50) colorClass = 'bg-yellow-500';
                    if (aqi > 100) colorClass = 'bg-orange-500';
                    if (aqi > 150) colorClass = 'bg-red-500';
                    dot.className = `city-dot absolute w-4 h-4 rounded-full border-2 border-white ${colorClass}`;
                    
                    if(city === appState.selectedCity) {
                        dot.className += ' ring-4 ring-blue-400';
                    }
                });
            };

            const updatePollutantChart = () => {
                const ctx = document.getElementById('pollutantChart').getContext('2d');
                const cityData = mockData[appState.selectedCity].current.pollutants;

                if (charts.pollutant) charts.pollutant.destroy();

                charts.pollutant = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['NO‚ÇÇ', 'O‚ÇÉ', 'PM‚ÇÇ.‚ÇÖ'],
                        datasets: [{
                            data: [cityData.no2, cityData.o3, cityData.pm25],
                            backgroundColor: ['#f59e0b', '#10b981', '#6b7280'],
                            borderColor: '#ffffff',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { position: 'bottom' } }
                    }
                });
            };

            const updateForecastChart = () => {
                document.getElementById('current-city-forecast').textContent = appState.selectedCity;
                const ctx = document.getElementById('forecastChart').getContext('2d');
                const forecastData = mockData[appState.selectedCity].forecast;
                const labels = Array.from({ length: 24 }, (_, i) => `${i}:00`);

                if (charts.forecast) charts.forecast.destroy();

                charts.forecast = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'AQI Forecast',
                            data: forecastData,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'AQI Value' } } }
                    }
                });
            };

            const updateComparisonChart = () => {
                document.getElementById('current-city-comparison').textContent = appState.selectedCity;
                const pollutant = document.getElementById('pollutantSelector').value;
                const comparisonData = mockData[appState.selectedCity].comparison[pollutant];
                
                const ctx = document.getElementById('comparisonChart').getContext('2d');
                if (charts.comparison) charts.comparison.destroy();

                charts.comparison = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['NASA TEMPO (Satellite)', 'Ground Sensor'],
                        datasets: [{
                            label: pollutant.toUpperCase() + ' Concentration',
                            data: [comparisonData.tempo, comparisonData.ground],
                            backgroundColor: ['#8b5cf6', '#10b981'],
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Concentration (Œºg/m¬≥)' } } },
                        plugins: { legend: { display: false } }
                    }
                });
            };

            const updateHistoryChart = () => {
                document.getElementById('current-city-history').textContent = appState.selectedCity;
                const year = document.getElementById('historyYearSelector').value;
                const historyData = mockData[appState.selectedCity].history[year];
                const labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                
                const ctx = document.getElementById('historyChart').getContext('2d');
                if (charts.history) charts.history.destroy();

                charts.history = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: `Monthly Average AQI in ${year}`,
                            data: historyData,
                            backgroundColor: '#1d4ed8'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Average AQI' } } },
                        plugins: { legend: { display: false } }
                    }
                });
            };

            const renderView = () => {
                document.querySelectorAll('.view').forEach(view => view.classList.add('hidden'));
                document.getElementById(appState.currentView).classList.remove('hidden');

                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.toggle('active', link.dataset.view === appState.currentView);
                });

                switch(appState.currentView) {
                    case 'dashboard':
                        updateDashboard();
                        break;
                    case 'forecast':
                        updateForecastChart();
                        break;
                    case 'comparison':
                        updateComparisonChart();
                        break;
                    case 'history':
                        updateHistoryChart();
                        break;
                }
            };
            
            document.querySelector('nav').addEventListener('click', (e) => {
                if (e.target.matches('.nav-link')) {
                    e.preventDefault();
                    appState.currentView = e.target.dataset.view;
                    renderView();
                }
            });

            document.querySelector('.lg\\:col-span-2').addEventListener('click', (e) => {
                if (e.target.matches('.city-dot')) {
                    appState.selectedCity = e.target.dataset.city;
                    updateDashboard();
                    if(appState.currentView === 'forecast') updateForecastChart();
                    if(appState.currentView === 'comparison') updateComparisonChart();
                    if(appState.currentView === 'history') updateHistoryChart();
                }
            });

            document.getElementById('pollutantSelector').addEventListener('change', updateComparisonChart);
            document.getElementById('historyYearSelector').addEventListener('change', updateHistoryChart);
            
            document.getElementById('locationSearch').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    const query = e.target.value.toLowerCase().trim();
                    const foundCity = Object.keys(mockData).find(city => city.toLowerCase() === query);
                    if (foundCity) {
                        appState.selectedCity = foundCity;
                        renderView();
                    } else {
                        alert('City not found in mock data. Try "Los Angeles", "Mexico City", "New York", "Chicago", or "Edmonton".');
                    }
                }
            });

            renderView();
        });
    </script>
</body>
</html>
